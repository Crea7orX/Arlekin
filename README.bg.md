# Arlekin üåç

**Arlekin** –µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å—ä—Å —Å–ø–æ–¥–µ–ª–µ–Ω–∞ –∫–∞—Ä—Ç–∞, –∫–æ—è—Ç–æ –ø–æ–∑–≤–æ–ª—è–≤–∞ –Ω–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏—Ç–µ –¥–∞ –ø–æ—Å—Ç–∞–≤—è—Ç –ø–∏–Ω–æ–≤–µ —Å –≤–∏–¥–µ–æ –ª–∏–Ω–∫–æ–≤–µ –Ω–∞ –≥–ª–æ–±–∞–ª–Ω–∞ –∫–∞—Ä—Ç–∞. –ò–∑–≥—Ä–∞–¥–µ–Ω–∞ —Å **Next.js 15 (App Router)**, **PostgreSQL**, **Drizzle ORM**, **Leaflet** –∏ **Clerk** –∑–∞ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∞—Ü–∏—è.

## üé≠ About

–¢–æ–∑–∏ –ø—Ä–æ–µ–∫—Ç –µ —Å—ä–∑–¥–∞–¥–µ–Ω –∑–∞ –ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–∏—è —Ñ–µ—Å—Ç–∏–≤–∞–ª –ê—Ä–ª–µ–∫–∏–Ω.

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –Ω—è–∫–æ–ª–∫–æ –µ–∑–∏–∫–∞

–¢–∞–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –µ –Ω–∞–ª–∏—á–Ω–∞ –Ω–∞ —Å–ª–µ–¥–Ω–∏—Ç–µ –µ–∑–∏—Ü–∏:

- [![en](https://img.shields.io/badge/lang-en-red.svg)](./README.md)
- [![bg](https://img.shields.io/badge/lang-bg-green.svg)](./README.bg.md)

---

## ‚ú® –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç–∏

- üó∫Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –∫–∞—Ä—Ç–∞ —Å Leaflet
- üìç –î–æ–±–∞–≤—è–Ω–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–∏–Ω–æ–≤–µ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω–∏ –∏ –≤–∏–¥–µ–æ
- üîê –ó–∞—â–∏—Ç–µ–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∞—Ü–∏—è —á—Ä–µ–∑ Clerk
- üê≥ –ü–æ–¥–¥—Ä—ä–∂–∫–∞ —Å Docker –∑–∞ –ª–µ—Å–Ω–æ –¥–µ–ø–ª–æ–π–≤–∞–Ω–µ
- üì¶ –ò–∑–ø–æ–ª–∑–≤–∞ Drizzle ORM –∏ PostgreSQL

---

## üß≠ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Arlekin/
‚îú‚îÄ‚îÄ src/
‚îú‚îÄ‚îÄ public/
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ docker-compose-without-db.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ drizzle.config.ts
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ —Å—Ä–µ–¥–∞

1. **–ö–ª–æ–Ω–∏—Ä–∞–Ω–µ –Ω–∞ —Ä–µ–ø–æ—Ç–æ:**

   ```bash
   git clone https://github.com/Crea7orX/Arlekin.git
   cd arlekin
   ```

2. **–ö–æ–ø–∏—Ä–∞–Ω–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–µ –Ω–∞ .env —Ñ–∞–π–ª–∞:**

   ```bash
   cp .env.example .env
   ```

3. **–ó–∞–¥–∞–≤–∞–Ω–µ –Ω–∞ API base URL-–∞:**

   ```env
   NEXT_PUBLIC_API_BASE_URL=http://localhost:3000/api
   ```

4. **–í—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç Clerk:**

   ```env
   NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_
   CLERK_SECRET_KEY=sk_test_
   ```

5. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ –±–∞–∑–∞—Ç–∞ –¥–∞–Ω–Ω–∏:**

   ```env
   DATABASE_URL=postgresql://postgres:postgres@postgres:5432/arlekin
   ```

---

## üê≥ –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ —Å Docker

1. **–°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —É—Å–ª—É–≥–∏—Ç–µ:**

   ```bash
   docker-compose up -d --build
   ```

2. **Frontend:** http://localhost:3000  
   **API:** http://localhost:3000 (–≤ Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ—Ç–æ)

–ê–∫–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—Ç–µ –≤—ä–Ω—à–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω–∏, –∏–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ:

```bash
docker-compose -f docker-compose-without-db.yml up -d --build
```

---

## üß™ –õ–æ–∫–∞–ª–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–≤–∞–Ω–µ (–±–µ–∑ Docker)

```bash
pnpm install
pnpm dev
```

---

## üóÉÔ∏è –°–∫—Ä–∏–ø—Ç–æ–≤–µ

| –ö–æ–º–∞–Ω–¥–∞            | –û–ø–∏—Å–∞–Ω–∏–µ                      |
| ------------------ | ----------------------------- |
| `pnpm dev`         | –°—Ç–∞—Ä—Ç–∏—Ä–∞ dev —Å—ä—Ä–≤—ä—Ä           |
| `pnpm build`       | –ò–∑–≥—Ä–∞–∂–¥–∞ production build     |
| `pnpm start`       | –°—Ç–∞—Ä—Ç–∏—Ä–∞ production —Å—ä—Ä–≤—ä—Ä    |
| `pnpm db:generate` | –ì–µ–Ω–µ—Ä–∏—Ä–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏–∏  |
| `pnpm db:push`     | –ò–∑–ø—ä–ª–Ω—è–≤–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ |

---

## üîê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Clerk

- `src/middleware.ts` —Å—ä–¥—ä—Ä–∂–∞ middleware –∑–∞ –∞–≤—Ç–µ–Ω—Ç–∏–∫–∞—Ü–∏—è
- Frontend-–∞ –∏–∑–ø–æ–ª–∑–≤–∞ `@clerk/nextjs`
- –ó–∞—â–∏—Ç–µ–Ω–∏ API –º–∞—Ä—à—Ä—É—Ç–∏ –≤ `src/app/api`  
  –£–±–µ–¥–µ—Ç–µ —Å–µ, —á–µ –≤—Å–∏—á–∫–∏ Clerk –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏ —Å–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–∏.

---

## üß≠ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–∞ –∏ –ø–∏–Ω–æ–≤–µ

–ì–ª–∞–≤–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ:

- `src/components/map-section.tsx`
- `src/components/pin-add-dialog.tsx`
- `src/app/api/pins/*`

---

## üßº –ò–∑—á–∏—Å—Ç–≤–∞–Ω–µ

–ó–∞ —Å–ø–∏—Ä–∞–Ω–µ –∏ –ø—Ä–µ–º–∞—Ö–≤–∞–Ω–µ –Ω–∞ —É—Å–ª—É–≥–∏—Ç–µ:

```bash
docker-compose down
```

–ó–∞ –ø—Ä–µ–º–∞—Ö–≤–∞–Ω–µ –Ω–∞ –æ–±–µ–º–∏:

```bash
docker-compose down --volumes
```

---

## üöÄ –°—ä–≤–µ—Ç–∏ –∑–∞ —Ä–∞–∑–≥—Ä—ä—â–∞–Ω–µ

- –ü—É–±–ª–∏–∫—É–≤–∞–π—Ç–µ Docker –æ–±—Ä–∞–∑–∏ –≤ DockerHub –∏–ª–∏ –¥—Ä—É–≥ —Ä–µ–≥–∏—Å—Ç—ä—Ä
- –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ Docker Compose –∏–ª–∏ Kubernetes –∑–∞ production
- –ê–∫—Ç–∏–≤–∏—Ä–∞–π—Ç–µ SSL —á—Ä–µ–∑ Traefik/Nginx
- –°—ä—Ö—Ä–∞–Ω—è–≤–∞–π—Ç–µ .env –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏—Ç–µ –≤ secrets manager
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–¥–æ–≤–Ω–∏ —Ä–µ–∑–µ—Ä–≤–Ω–∏ –∫–æ–ø–∏—è –Ω–∞ PostgreSQL

---

## üìÑ –õ–∏—Ü–µ–Ω–∑

–ü—Ä–æ–µ–∫—Ç—ä—Ç –µ —Å –æ—Ç–≤–æ—Ä–µ–Ω –∫–æ–¥ –∏ —Å–µ —Ä–∞–∑–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–≤–∞ –ø–æ–¥ GNU 3 –ª–∏—Ü–µ–Ω–∑.
